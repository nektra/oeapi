<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>OEAPI: OEAPI Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li class="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>OEAPI Documentation</h1>
<p>
<h3 align="center">3.2.3 </h3><h2><a class="anchor" name="section1">
OEAPI Components:</a></h2>
<ul>
<li>oeapiinitcom.dll: Contains the <a class="el" href="namespace_o_e_a_p_i_i_n_i_t_c_o_m.html">OEAPIINITCOM</a> library. It contains the OEAPIInit ActiveX object that triggers the event OnInitOEAPI when the OE starts running and the event OnShutdownOEAPI when OE shutdowns. Between these two events you can instance any object of <a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> library (see <a class="el" href="oecom_8idl.html">oecom.idl</a>) without launching OE.</li></ul>
<p>
<ul>
<li>oecom.dll: This dll runs in the address space of OE and must be loaded by oehook.dll when OE starts running. If you instance any object of this dll (<a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> library) you launch OE (see in the demo application what happens if you create a toolbar and OE is not running) as it registers the COM server in the OE. NOTE: You must release all objects of this library in OnShutdownOEAPI event. Otherwise, this library will not shutdown, the OE (msimn.exe) process will continue running in the background and OE will not be able to load again.</li></ul>
<p>
<ul>
<li>oestore.dll: This dll contains <a class="el" href="namespace_o_e_s_t_o_r_e.html">OESTORE</a> library that lets you instance the main object OEFolderManager. It lets you use folders and messages. You can use these objects without launching OE.</li></ul>
<p>
<ul>
<li>oehook.dll: This dll must be loaded from an application that runs from start-up. It loads oecom.dll when OE is launched. This dll implements a window hook and is loaded only in OE and the process that loads this dll. To do this, it returns FALSE when other processes try to load it (In NT this cannot be done so it is loaded in all the processes). When a dll returns FALSE in DllMain generates a debug line saying that the dll was loaded first and unloaded after. To prevent this behaviour set the registry key: HKEY_CURRENT_USER\SOFTWARE\Nektra\<a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> Value: HookAllProcesses REG_DWORD = 1. Setting this value makes the hook dll to be loaded in all the processes and the debug lines are not printed.</li></ul>
<p>
<ul>
<li>launcher.exe: It's an application that runs from start-up and just loads oehook.dll.</li></ul>
<p>
<br>
 <h2><a class="anchor" name="section2">
Deploying OEAPI</a></h2>
<ul>
<li><a href="deploying.html">Click here for OEAPI deploying instructions.</a></li></ul>
<p>
<br>
 <h2><a class="anchor" name="section3">
Working with .NET guideline</a></h2>
<ul>
<li><a href="dotnet.html">Click here for a guideline to work with .NET.</a></li></ul>
<p>
<br>
 <h2><a class="anchor" name="section4">
About the demo applications:</a></h2>
Demo applications weren't made to test the <a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> stability, it were written just to show the actual functionality of the library. The <a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> is the result of long research and development made for several customers. Our knowledge allowed us to create the <a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> joining all that work in some COM objects. We have achieved an important speed improvement of the library using a lot of information we have learned. For documentation of the methods use the object browser.<p>
<br>
 <h2><a class="anchor" name="section5">
About VC++ demo application:</a></h2>
You need to install Comet library before compiling the demo in VC++ (<a href="http://www.lambdasoft.dk/comet/download.htm">http://www.lambdasoft.dk/comet/download.htm</a>). The application is a full example of the library's features. Objects of the <a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> library must be instanced when the library is active or you will run OE when CoCreateInstance is called. In the example if you create a toolbar when OE is not running, you will implicitlly run OE.<p>
<br>
 <h2><a class="anchor" name="section6">
To use OEAPI from Delphi:</a></h2>
<ul>
<li>Select: Project -&gt; Import Type Library.</li><li>Select <a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> in the listbox and press ‘Install’.</li><li>Select the tab ‘Into new package’ and choose a name (e.g.: <a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a>).</li><li>After building the package do the same with ‘OEAPIINITCOM’ and ‘OESTORE’ but after pressing Install, select ‘Into existing package’ and select the previous created package.</li><li>After doing all this <a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> can be used as any ActiveX control: Remember that when you ‘Connect’ <a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> library you will implicitly launch OE as it is registered in OE.</li></ul>
<p>
<br>
 <h2><a class="anchor" name="section7">
Functionality:</a></h2>
Local folders:<ul>
<li>Only local folders are supported at the moment.</li></ul>
<p>
Identities:<ul>
<li>To handle identities it is important to force reload of <a class="el" href="namespace_o_e_s_t_o_r_e.html">OESTORE</a> library during the OnInitOEAPI event of the <a class="el" href="namespace_o_e_a_p_i_i_n_i_t_c_o_m.html">OEAPIINITCOM</a> library. To be able to do this <b>you need to release all the objects of <a class="el" href="namespace_o_e_s_t_o_r_e.html">OESTORE</a> library first</b>. See how this is handled in demo applications.</li></ul>
<p>
<br>
 <h2><a class="anchor" name="section8">
About OEAPI Source Code:</a></h2>
<a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> source code can be bought for U$999. To compile <a class="el" href="namespace_o_e_a_p_i.html">OEAPI</a> you need to download and install Comet library (<a href="http://www.lambdasoft.dk/comet/download.htm">http://www.lambdasoft.dk/comet/download.htm</a>). If you get errors verify if you have already installed Microsoft SDK. </div>
<br>
<br>
<p align = "right">Developed by <a href="http://www.nektra.com" target="_blank">Nektra</a></p>
